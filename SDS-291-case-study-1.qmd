---
title: "Case Study 1: Your Informative Title Here"
author: "Miya Dang, Mia Tran"
date: "Wednesday, March 5, 2025"
format: 
  pdf:
    keep-tex: true
    include-in-header: 
       text: |
         \usepackage{fvextra}
         \DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}
         \DefineVerbatimEnvironment{OutputCode}{Verbatim}{breaklines,commandchars=\\\{\}}
    geometry: 
      - left=1in
      - right=1in
      - top=1in
      - bottom=1in
---

Let $Buchanan$ denote the votes for Buchanan in Palm Beach County and $Bush$ denote the the votes for Bush in Palm Beach County. Our final linear regression model is: $$E[log(Buchanan) | log(Bush)] = \beta_0 + \beta_1\left(Bush\right).$$

The prediction interval is $[365, 831]$. We are 95% confident that the votes for Buchanan when there are 152846 votes for Bush will fall between 365 votes and 831 votes.

Buchanan's real vote from Palm Beach County in 2000 election is 3407 votes. Compared to the prediction interval above, we can calculate that an estimate for the likely number of votes intended for Gore but cast for Buchanan in Palm Beach County falls between $[2576, 3042]$.

## R Appendix

```{r}
#| message: FALSE
#| warning: FALSE

# Loading necessary packages
library(tidyverse)
library(Sleuth2)
library(broom)        
library(kableExtra)   

# Loading the data for case study one
election <- Sleuth2::ex0825

# Creating a second dataset with Palm Beach County excluded
election_wo_pb <- election |>
  filter(County != "Palm Beach")

# Creating a scatterplot for the relationship between Bush and Buchanan votes
election_wo_pb |>
  ggplot(aes(x = Bush2000,
             y = Buchanan2000)) +
  geom_point() +
  ggtitle("Association between Bush votes and Buchanan votes")

# Fitting and summarizing the regression line for mean Buchanan votes 
# as a function of Bush votes
election_lm <- lm(Buchanan2000 ~ Bush2000, data = election_wo_pb)
summary(election_lm)$coefficients
election_lm_table <- summary(election_lm)$coefficients

# Creating the table summarizing the estimated coefficients of the model 
# and their corresponding standard errors
election_lm_table |> kbl(col.names = c("Estimate", "Std. Error",
                                       "t value", "Pr(>|t|)"), 
                         align = "c",
                         booktabs = T,
                         linesep="",
                         digits = c(4, 4, 4, 4)) |>
  kable_classic(full_width = F, latex_options = c("HOLD_position"))

# Creating the residuals-fitted plot to check 
# Linearity and Equal Variance for the election model
election_lm |>
  augment() |>
  ggplot(aes(x = .fitted, y = .resid)) +
  geom_point() +
  geom_hline(yintercept = 0, col = "red") +
  xlab("Fitted Values") +
  ylab("Residuals") +
  theme_bw()

# Creating the Q-Q plot as check Normality for the election model
election_lm |>
  augment() |>
  ggplot(aes(sample = .resid)) +
  geom_qq() +
  geom_qq_line(col = "blue") +
  xlab("Theoretical Quantiles") +
  ylab("Sample Quantiles") +
  theme_bw()

#Transformation
transformed_election_lm <- lm(log(Buchanan2000) ~ log(Bush2000), election_wo_pb)

# Creating the residuals-fitted plot to check 
# Linearity and Equal Variance for the transformed election model
transformed_election_lm |>
  augment() |>
  ggplot(aes(x = .fitted, y = .resid)) +
  geom_point() +
  geom_hline(yintercept = 0, col = "red") +
  xlab("Fitted Values") +
  ylab("Residuals") +
  theme_bw()

# Creating the Q-Q plot as check Normality for the transformed election model
transformed_election_lm |>
  augment() |>
  ggplot(aes(sample = .resid)) +
  geom_qq() +
  geom_qq_line(col = "blue") +
  xlab("Theoretical Quantiles") +
  ylab("Sample Quantiles") +
  theme_bw()

# Filter the original dataset to only Palm Beach Country
# to create prediction interval
election_pb <- election |> filter(County == "Palm Beach")

# Creating a 95% prediction interval for the number of
# predicted Buchanan votes in Palm Beach County
# after knowing the votes for Bush from Palm Beach County
new_election <- data.frame(Bush2000 = 152846)
election_lm |>
  augment(newdata = new_election,
          interval = "prediction",
          conf.level = 0.95)

```
